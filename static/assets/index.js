var w=Object.defineProperty;var v=(e,t,o)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var a=(e,t,o)=>v(e,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();function h(e){const t=document.getElementById("log");t.textContent=`${e} 
${t.textContent}`}function S(e){let t=e.identifier%16,o=Math.floor(e.identifier+5)%16,i=Math.floor(e.identifier+10)%16;return`#${t.toString(16)}${t.toString(16)}${o.toString(16)}${o.toString(16)}${i.toString(16)}${i.toString(16)}`}function u(e,t,o,i,n,s,r,m){const d=e.createLinearGradient(t,o,i,n);if(s.length!=7)return s;const _=s+Math.floor(r*255).toString(16).padStart(2,"0");d.addColorStop(0,_);const y=s+Math.floor(m*255).toString(16).padStart(2,"0");return d.addColorStop(1,y),d}window.onload=window.onresize=function(){const e=document.getElementById("canvas");e.width=window.innerWidth,e.height=window.innerHeight};const f=1500,c=[];class ${constructor(t){a(this,"points",[]);a(this,"id",-1);a(this,"color");a(this,"segment_end_index",-1);a(this,"segment_threshold",.1);this.id=t.identifier,this.points.push({x:t.pageX,y:t.pageY,timestamp:Date.now(),alpha:1}),this.color=S(t)}update_from_touch(t){this.points.push({x:t.pageX,y:t.pageY,timestamp:Date.now(),alpha:1})}fade_old_points(){const t=Date.now(),o=t-f;var i=0,n=-1;this.points.forEach((s,r)=>{s.timestamp<=o?(s.alpha=0,i=r+1):(s.alpha=1-(t-s.timestamp)/f,n==-1&&s.alpha>this.segment_threshold&&(n=r))}),i>0&&this.points.splice(0,i),this.segment_end_index=n-i}draw(t){if(this.fade_old_points(),this.points.length<2)return;t.lineWidth=4,t.beginPath();const{x:o,y:i}=this.points[0];t.moveTo(o,i);for(var n=1;n<this.points.length-2;n++){const s=(this.points[n].x+this.points[n+1].x)/2,r=(this.points[n].y+this.points[n+1].y)/2;t.quadraticCurveTo(this.points[n].x,this.points[n].y,s,r),n==this.segment_end_index&&(t.strokeStyle=u(t,o,i,s,r,this.color,0,1),t.stroke(),t.beginPath(),t.moveTo(s,r))}t.quadraticCurveTo(this.points[this.points.length-2].x,this.points[this.points.length-2].y,this.points[this.points.length-1].x,this.points[this.points.length-1].y),this.segment_end_index<=-1||this.segment_end_index>=this.points.length-2?t.strokeStyle=u(t,o,i,this.points[this.points.length-1].x,this.points[this.points.length-1].y,this.color,0,this.points[this.points.length-1].alpha):t.strokeStyle=this.color,t.stroke(),this.id>=0&&(t.beginPath(),t.arc(this.points[this.points.length-1].x,this.points[this.points.length-1].y,20,0,2*Math.PI),t.stroke())}reset(){this.points.length=0}}function p(){var e=new WebSocket(`ws://${location.hostname}:8080`);e.onopen=function(){},e.onmessage=function(t){h(`Message: ${t.data}`)},e.onclose=function(t){h(`Socket closed, reason: ${t.reason}. Reconnect in 1 second.`),setTimeout(function(){p()},1e3)},e.onerror=function(t){console.error("Socket encountered error: ",t,"Closing socket"),e.close()}}function E(){const e=document.getElementById("canvas");e.addEventListener("touchstart",C),e.addEventListener("touchend",x),e.addEventListener("touchcancel",T),e.addEventListener("touchmove",L),p(),requestAnimationFrame(g),h("initialized...")}function g(){const e=document.getElementById("canvas"),t=e.getContext("2d");if(!t){h("ERROR: Could not Create Context");return}t.clearRect(0,0,e.width,e.height);let o=-1;c.forEach((i,n)=>{i.draw(t),i.id==-1&&i.points.length==0&&(o=n)}),o!=-1&&c.splice(o,1),requestAnimationFrame(g)}function l(e){var t;for(let o=0;o<c.length;o++)if(((t=c[o])==null?void 0:t.id)===e)return o;return-1}function C(e){e.preventDefault();const t=e.changedTouches;for(let o=0;o<t.length;o++){const i=t[o];if(!i)continue;h(`touchstart: ${i.identifier}`);const n=new $(i);c.push(n),c.length-1,i.pageX/this.width,i.pageY/this.height}}function L(e){e.preventDefault();const t=e.changedTouches;for(let o=0;o<t.length;o++){const i=t[o];if(!i)continue;const n=l(i.identifier);if(n===-1){h(`could not continue touch ${i.identifier}`);continue}const s=c[n];s==null||s.update_from_touch(i),i.pageX/this.width,i.pageY/this.height}}function x(e){e.preventDefault();const t=e.changedTouches;for(let o=0;o<t.length;o++){const i=t[o];if(!i)continue;const n=l(i.identifier);if(n===-1){h(`could not end touch ${i.identifier}`);continue}const s=c[n];s.id=-1}}function T(e){e.preventDefault();const t=e.changedTouches;for(let o=0;o<t.length;o++){const i=t[o];if(!i)continue;const n=l(i.identifier);if(n===-1){h(`could not cancel touch ${i.identifier}`);continue}const s=c[n];s.id=-1}}document.addEventListener("DOMContentLoaded",E);
